{
  "_meta": {
    "description": "Test file reorganization plan for lib/i2cp/",
    "convention": "{source_file}_{category}_test.go",
    "categories": ["unit", "integration", "fuzz", "validation"],
    "source_files_dissolved": [
      "security_test.go",
      "edge_case_fixes_test.go",
      "session_status_regression_test.go",
      "message_status_test.go (split)",
      "host_lookup_test.go (split)",
      "server_message_test.go (split)",
      "publisher_test.go (split)",
      "leaseset2_validation_test.go (split)"
    ],
    "original_file_count": 29,
    "final_file_count": 13
  },

  "auth_unit_test.go": [
    "auth_test.go: TestPasswordAuthenticator_*, TestServer_Auth*, TestParseGetDateOptions_*, TestSplitKeyValue"
  ],

  "protocol_unit_test.go": [
    "protocol_test.go: TestMessageMarshalUnmarshal, TestMessageUnmarshalErrors, TestReadWriteMessage, TestMessageTypeName, TestReservedSessionIDs, BenchmarkMessageMarshal, BenchmarkMessageUnmarshal, TestMessagePayloadSizeLimit, TestReadMessagePayloadSizeLimit, TestProtocolConstants, TestMessageTypeNames",
    "message_status_test.go: TestMessageStatusConstants, TestMessageTypeMessageStatus, TestMessageStatusUnmarshal"
  ],

  "protocol_validation_test.go": [
    "protocol_compliance_test.go: TestProtocolByteValidation, TestMessageTypeHandlers, TestVersionNegotiation, TestRateLimitingEnforcement, TestPayloadSizeEnforcement, TestMessageWireFormat, TestMessageRoundTrip, TestReservedSessionIDConstants, TestProtocolVersionConstants",
    "security_test.go: TestProtocolCompliance_MessageTypeConstants, TestProtocolCompliance_VersionString, TestProtocolCompliance_ReservedSessionIDs, TestProtocolCompliance_MessageStatusCodes, TestMessageFraming_PayloadSizeLimits, TestMessageFraming_OversizedPayloadRejected, TestMessageFraming_ValidPayloadAccepted, TestMessageFraming_EmptyPayloadValid, TestMessageFraming_RoundTrip, TestMessageFraming_TruncatedMessageRejected, TestErrorMessages_NoSensitiveData",
    "session_status_regression_test.go: TestSessionStatusConstants"
  ],

  "payload_unit_test.go": [
    "payload_test.go: TestParseSendMessagePayload, TestSendMessagePayloadMarshalBinary, TestSendMessagePayloadRoundTrip, TestParseMessagePayloadPayload, TestMessagePayloadPayloadMarshalBinary, TestMessagePayloadPayloadRoundTrip, TestSendMessagePayloadEmptyPayload, TestMessagePayloadPayloadZeroID, BenchmarkParseSendMessagePayload, BenchmarkParseMessagePayloadPayload",
    "host_lookup_test.go: TestHostLookupPayloadParse, TestHostLookupPayloadMarshal, TestHostLookupRoundTrip, TestHostReplyPayloadParse, TestHostReplyPayloadMarshal, TestHostReplyRoundTrip, TestHostLookupConstants, TestHostLookupTypeNames",
    "blinding_info_test.go: TestBlindingInfoPayloadParse, TestBlindingInfoPayloadMarshal, TestBlindingInfoRoundTrip, TestBlindingInfoConstants, TestBlindingInfoEnableDisable, TestBlindingInfoSecretFormats",
    "disconnect_test.go: TestDisconnectPayloadParse, TestDisconnectPayloadMarshal, TestDisconnectRoundTrip, TestDisconnectCommonReasons, TestDisconnectMaxLength",
    "send_message_expires_test.go: TestSendMessageExpiresPayloadParse, TestSendMessageExpiresPayloadMarshal, TestSendMessageExpiresRoundTrip, TestMessageTypeSendMessageExpires, TestMessageTypeDisconnect, TestExpirationTime",
    "security_test.go: TestHostLookup_PayloadParsing, TestHostLookup_ReplyPayloadMarshaling, TestBlindingInfo_PayloadParsing"
  ],

  "server_unit_test.go": [
    "server_test.go: TestServerStartStop, TestServerDoubleStart, TestServerCreateSession, TestServerDestroySession, TestServerMaxSessions, TestServerGetDate, TestServerHandleCreateLeaseSet, BenchmarkServerCreateSession, TestServerConnWriteMuInitialized",
    "server_message_test.go: TestHandleSendMessage, TestHandleSendMessageNoSession, TestHandleSendMessageInvalidPayload, TestDeliverMessagesToClientIntegration, TestDeliverMessagesToClientMultiple, TestDeliverMessagesToClientMessageIDIncrement",
    "server_payload_test.go: TestDestroySessionPayloadFormat, TestBuildRequestVariableLeaseSetPayload_FilteredCount, TestBuildRequestVariableLeaseSetPayload_AllFilteredReturnsError, TestBuildRequestVariableLeaseSetPayload_AllValid",
    "server_tunnel_pool_test.go: TestServerTunnelPoolConfiguration, TestServerTunnelPoolWithoutInfrastructure, TestServerTunnelPoolConfigurationFromSessionConfig, TestServerSetTunnelBuilderThreadSafety, TestServerSetPeerSelectorThreadSafety",
    "host_lookup_test.go: TestHandleHostnameLookup_NoResolver, TestHandleHostnameLookup_WithResolver_Found, TestHandleHostnameLookup_WithResolver_NotFound, TestHandleHostnameLookup_WithResolver_Error, TestSetHostnameResolver",
    "leaseset_publishing_test.go: TestHandleCreateLeaseSetWithPublisher, TestHandleCreateLeaseSetWithoutPublisher, TestHandleCreateLeaseSetPublisherError, TestHandleCreateLeaseSetNoActiveTunnels, TestHandleCreateLeaseSetMultipleCalls, TestHandleCreateLeaseSetNilSession, TestLeaseSetPublishedDataIntegrity, BenchmarkHandleCreateLeaseSetWithPublisher, BenchmarkHandleCreateLeaseSetWithoutPublisher",
    "session_status_regression_test.go: TestSessionStatusCreatedCode, TestSessionStatusDestroyedCode, TestParseSendMessagePayloadWithSessionIDPrefix, TestParseSendMessagePayloadTooShort, TestParseSendMessageExpiresPayloadWithSessionIDPrefix, TestParseSendMessageExpiresPayloadTooShort, TestHandleSendMessageWithWireFormatPayload",
    "message_status_test.go: TestBuildMessageStatusResponse, TestBuildMessageStatusResponseMarshal, TestMessageIDGeneration, TestMessageStatusPayloadFormat",
    "publisher_test.go: TestServerWithLeaseSetPublisher, TestServerWithoutLeaseSetPublisher"
  ],

  "server_validation_test.go": [
    "leaseset2_validation_test.go: TestHandleCreateLeaseSet2_WithValidation, TestHandleCreateLeaseSet2_RejectsGarbage, TestHandleCreateLeaseSet2_RejectsWrongDestination, TestHandleCreateLeaseSet2_RejectsTooShort"
  ],

  "session_unit_test.go": [
    "session_test.go: TestDefaultSessionConfig, TestSessionGetters, TestNewSession, TestSessionQueueMessage, TestSessionQueueFull, TestSessionStop, TestSessionReconfigure, TestSessionManager, TestSessionManagerDestroy_NotFound, TestSessionManager_MultipleCreatesAndDestroys, BenchmarkSessionQueueMessage, BenchmarkSessionManagerCreateDestroy, TestSessionCreateLeaseSetNoInboundPool, TestSessionCreateLeaseSetInactiveSession, TestSessionCreateLeaseSetNoActiveTunnels, TestSessionCreateLeaseSetWithActiveTunnels, TestSessionCurrentLeaseSet, TestSessionLeaseSetAge, TestStartLeaseSetMaintenanceNoInboundPool, TestStartLeaseSetMaintenanceInactiveSession, TestStartLeaseSetMaintenanceSuccess, TestLeaseSetMaintenanceRegeneration, TestLeaseSetMaintenanceStopCleanup, TestMaintainLeaseSetDirectCall, TestLeaseSetRegenerationThreshold, TestStopTunnelPools, TestStopTunnelPools_NilPools",
    "session_identity_test.go: TestPrepareDestinationAndKeys_WithPrivateKeys_PreservesIdentity, TestNewSession_WithPrivateKeys_PreservesIdentity, TestCreateSession_WithPrivateKeys_PreservesIdentity, TestNewSession_WithoutPrivateKeys_GeneratesFreshIdentity, TestNewSession_WithNilDestAndNilKeys_GeneratesFreshIdentity, TestPrepareDestinationAndKeys_WithPartialKeys_GeneratesFresh, TestPrepareDestinationAndKeys_IdentityStableAcrossReconstructions, TestNewSession_VariadicPrivKeysBackwardCompat",
    "session_keys_race_test.go: TestNewSession_WithExternalDestination_HasKeys, TestNewSession_WithNilDestination_HasKeys, TestPrepareDestinationAndKeys_ExternalDest_ReturnsValidKeyStore, TestPrepareDestinationAndKeys_NilDest_ReturnsValidKeyStore, TestValidateSessionState_NilKeys_ReturnsError, TestDestroySession_Idempotent, TestDestroySession_ConcurrentDoubleCleanup, TestSessionManager_CreateAndDestroyMultiple, TestSessionManager_CreateWithExternalDest",
    "session_encrypted_leaseset_test.go: TestSessionConfigEncryptedLeaseSet, TestValidateEncryptedLeaseSetSupport, TestEnsureBlindingSecret, TestUpdateBlindedDestination, TestGenerateEncryptionCookie, TestCreateEncryptedLeaseSetWithMockTunnels, TestCreateEncryptedLeaseSetSerialization, TestPublishLeaseSetNetworkWithEncrypted, TestRegenerateAndPublishWithEncrypted",
    "server_message_test.go: TestSessionQueueIncomingMessage, TestSessionQueueIncomingMessageAfterStop, TestSessionReceiveMessageAfterStop, TestSessionIncomingQueueFull",
    "security_test.go: TestSessionLimits_MaxSessionsEnforced, TestSessionLimits_SessionIDAllocation, TestSessionLimits_RandomSessionIDGeneration, TestSessionIsolation_SeparateNetDBPerSession, TestSessionIsolation_SeparateDestinations, TestSessionIsolation_MessageQueueSeparation, TestDisconnectHandling_GracefulCleanup, TestDisconnectHandling_MultipleStopSafe, TestDisconnectHandling_QueueRejectedAfterStop, TestDisconnectHandling_ReceiveReturnsNilAfterStop, TestThreadSafety_ConcurrentSessionCreation, TestThreadSafety_ConcurrentSessionAccess, TestThreadSafety_ConcurrentMessageQueue, TestThreadSafety_SessionManagerConcurrentOps, TestRateLimiting_TokenBucketBasic, TestRateLimiting_TokenRefill, TestRateLimiting_DisabledWhenZeroRate, TestRateLimiting_NilRateLimiterAllows, TestLeaseSetPublishing_PublisherIntegration",
    "edge_case_fixes_test.go: TestMergeTunnelParameters_ZeroHopInbound, TestMergeTunnelParameters_ZeroHopOutbound, TestMergeTunnelParameters_NotExplicitlySetPreservesDefault, TestRateLimiter_LowRate, TestRateLimiter_FractionalAccumulation",
    "publisher_test.go: TestSessionSetLeaseSetPublisher, TestSessionPublishLeaseSetWithPublisher, TestSessionPublishLeaseSetWithoutPublisher, TestSessionPublishLeaseSetPublisherError, TestSessionMaintenanceWithPublisher",
    "leaseset2_validation_test.go: TestSetCurrentLeaseSet"
  ],

  "session_validation_test.go": [
    "leaseset2_validation_test.go: TestValidateLeaseSet2Data_ValidLeaseSet, TestValidateLeaseSet2Data_InvalidStructure, TestValidateLeaseSet2Data_DestinationMismatch, TestValidateLeaseSet2Data_CorruptedSigningKey, TestValidateLeaseSet2Data_TooShortPayload, TestValidateLeaseSet2Data_ExpiredLeaseSet"
  ],

  "session_config_parser_unit_test.go": [
    "session_config_parser_test.go: TestParseCreateSessionPayload_*, TestParseReconfigureSessionPayload*, TestValidateSessionConfig, TestApplyMessageOptions_*, TestLogUnsupportedBackupQuantities_*, TestApplyTunnelLifetimeOptions_*, TestFullParsePipeline_*"
  ],

  "message_router_unit_test.go": [
    "message_router_test.go: TestNewMessageRouter, TestRouteOutboundMessageSuccess, TestRouteOutboundMessageNoPool, TestRouteOutboundMessageNoActiveTunnels, TestSendThroughTunnel, TestSendThroughTunnelNoHops, TestRouteOutboundMessageZeroHopTunnelRejected, TestValidateAndSelectTunnelZeroHopRejection",
    "security_test.go: TestMessageRouter_StatusCallbackInvoked"
  ],

  "netdb_publisher_unit_test.go": [
    "netdb_publisher_test.go: TestNetDBLeaseSetPublisher_PublishLeaseSet, TestNetDBLeaseSetPublisher_StoreError, TestNetDBLeaseSetPublisherWithType, TestNetDBLeaseSetPublisher_DefaultType, TestNetDBLeaseSetPublisher_ImplementsInterface"
  ],

  "integration_test.go": [
    "integration_test.go: TestE2E_SessionCreation, TestE2E_LeaseSetCreation, TestE2E_LeaseSetMaintenance, TestE2E_MessageQueueing, TestE2E_ClientProtocolFlow, TestE2E_MessageDeliveryToClient, TestE2E_SessionLifecycleWithTunnels, TestE2E_MultipleSessionsConcurrent, TestE2E_LeaseSetRegenerationOnExpiry, TestE2E_SessionStopCleansUpResources, BenchmarkE2E_MessageThroughput, BenchmarkE2E_SessionCreation, TestE2E_OutboundMessageRouting",
    "error_flow_integration_test.go: TestErrorFlowIntegration_SessionCreationWithErrorHandling, TestErrorFlowIntegration_LeaseSetCreationWithErrorHandling, TestErrorFlowIntegration_ConcurrentSessionsWithErrorHandling, TestErrorFlowIntegration_MessageQueueingWithErrorHandling, TestErrorFlowIntegration_SessionLifecycleErrorRecovery"
  ],

  "mocks_test.go": [
    "mocks_test.go: keep as-is (shared test helpers)"
  ]
}
